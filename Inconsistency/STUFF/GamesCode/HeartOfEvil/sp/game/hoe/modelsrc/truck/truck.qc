// Output .MDL
$modelname "truck.mdl"

// Directory of .SMD

// Directory of .BMP
$cdmaterials Models/truck
$cliptotextures

// Write textures into a ???T.mdl
//$externaltextures

$surfaceprop "metal"

$scale 1.0

// bodygroups: use relative path from $cd
$bodygroup body
{
studio "truck.smd"
}

$bodygroup inside
{
studio "ref_seat.smd"
}


// .qc block generated by HLMV begins.

$surfaceprop "metal"
$jointsurfaceprop "view"	 "metal"
$jointsurfaceprop "Wheel_FL_Rotate"	 "metal"
$jointsurfaceprop "Wheel_FR_Rotate"	 "metal"
$jointsurfaceprop "Wheel_RR_Rotate"	 "metal"
$jointsurfaceprop "Wheel_RL_Rotate"	 "metal"


$hboxset "default"

$hbox 0 "polymsh"	   -59.00    0.00 -126.00    59.00  132.00  134.00
$hbox 0 "Wheel_FL_Rotate"	    -4.00  -22.00  -22.00     4.00   22.00   22.00
$hbox 0 "Wheel_FR_Rotate"	    -4.00  -22.00  -22.00     4.00   22.00   22.00
$hbox 0 "Wheel_RR_Rotate"	    -4.00  -22.00  -22.00     4.00   22.00   22.00
$hbox 0 "Wheel_RL_Rotate"	    -4.00  -22.00  -22.00     4.00   22.00   22.00

$hboxset "entryboxes"

$hbox 0 "polymsh"	  -140.00   15.00    0.00   -60.00  105.00  100.00
$hbox 0 "polymsh"	    60.00   15.00    0.00   140.00  105.00  100.00

// .qc block generated by HLMV ends.




$weightlist view_door view 1.0 Passenger_Door 1.0
$weightlist view view 1.0
$weightlist noview polymsh 1.0 Center 1.0 view 0.0

$sequence idle "seq_idle" loop fps 30 ACT_IDLE 1
$sequence enter1 "seq_enter1" fps 30 snap fadeout 0 {
    { event AE_CL_PLAYSOUND 0 "Truck.DoorStartOpen" }
    { event AE_CL_PLAYSOUND 39 "Truck.DoorEndClose" }
}
$sequence exit1 "seq_exit1" fps 30 fadeout 0 {
    { event AE_CL_PLAYSOUND 0 "Truck.DoorStartOpen" }
    { event AE_CL_PLAYSOUND 39 "Truck.DoorEndClose" }
}
$sequence exit2 "seq_exit2" fps 30 fadeout 0 {
    { event AE_CL_PLAYSOUND 15 "Truck.DoorStartOpen" }
    { event AE_CL_PLAYSOUND 40 "Truck.DoorEndClose" }
}

$poseparameter "player_lean" 0 1
$animation a_idle "seq_idle.smd" frames 0 0
$animation a_lean_out "seq_player_lean" frame 1 1 fps 10 subtract a_idle 0
$animation a_lean_in "seq_player_lean" frame 0 0 fps 10 subtract a_idle 0
$sequence player_lean { a_lean_in a_lean_out blend player_lean 0 1 } delta autoplay

$poseparameter "driver_door" 0 1
$animation a_ddoor_open "seq_driver_door" frame 1 1 fps 10 subtract a_idle 0
$animation a_ddoor_closed "seq_driver_door" frame 0 0 fps 10 subtract a_idle 0
$sequence driver_door { a_ddoor_closed a_ddoor_open blend driver_door 0 1 } delta autoplay

$attachment wheel_fl "Wheel_FL_Rotate" 0 0 0
$attachment wheel_fr "Wheel_FR_Rotate" 0 0 0
$attachment wheel_rl "Wheel_RL_Rotate" 0 0 0
$attachment wheel_rr "Wheel_RR_Rotate" 0 0 0

$attachment "vehicle_driver_eyes" "view" 0.00 0.00 0.00 rotate -90 -90 0
$attachment "vehicle_feet_passenger0" "polymsh" -20.00 36.00 48.00 rotate -90 -90 0
//$attachment "exit1" "polymsh" -96.00 84.00 44.00 rotate -90 -90 0
$attachment "seat_barney" "polymsh" 21.00 23.50 42.00 rotate -90 -90 0

$poseparameter "vehicle_steer" -1 1

$poseparameter "vehicle_wheel_fl_height" 0 1
$poseparameter "vehicle_wheel_fr_height" 0 1
$poseparameter "vehicle_wheel_rl_height" 0 1
$poseparameter "vehicle_wheel_rr_height" 0 1

$poseparameter "vehicle_wheel_fl_spin" -180 180 wrap
$poseparameter "vehicle_wheel_fr_spin" -180 180 wrap
$poseparameter "vehicle_wheel_rl_spin" -180 180 wrap
$poseparameter "vehicle_wheel_rr_spin" -180 180 wrap

$animation neutral "seq_idle.smd" frames 0 0

// turning
$weightlist front_wheels { "Wheel_FR_Turn" 1.0 "Wheel_FL_Turn" 1.0 }
$animation turn_left "seq_turn.smd" frame 0 0 subtract neutral 0 weightlist front_wheels
$animation turn_right "seq_turn.smd" frame 2 2 subtract neutral 0 weightlist front_wheels
$sequence turning { turn_left turn_right blend vehicle_steer -1 1 } weightlist front_wheels delta autoplay

// front right
$weightlist wheel_fr { "Wheel_FR" 1.0 }
$animation wheel_fr_low "seq_suspension.smd" frame 0 0 subtract neutral 0 weightlist wheel_fr
$animation wheel_fr_high "seq_suspension.smd" frame 2 2 subtract neutral 0 weightlist wheel_fr
$sequence wheel_fr_suspension { wheel_fr_low wheel_fr_high blend "vehicle_wheel_fr_height" 0 1.0 } weightlist wheel_fr delta autoplay

$weightlist rotate_fr { "Wheel_FR_Rotate" 1.0 }
$animation wheel_fr_spin0 "seq_spin.smd" frame 0 0 subtract neutral 0 weightlist rotate_fr
$animation wheel_fr_spin120 "seq_spin.smd" frame 1 1 subtract neutral 0 weightlist rotate_fr
$animation wheel_fr_spin240 "seq_spin.smd" frame 2 2 subtract neutral 0 weightlist rotate_fr
$sequence wheel_fr_spin { wheel_fr_spin0 wheel_fr_spin120 wheel_fr_spin240 wheel_fr_spin0 blendwidth 4 blend "vehicle_wheel_fr_spin" -180 180 } weightlist rotate_fr delta autoplay

// front left
$weightlist wheel_fl { "Wheel_FL" 1.0 }
$animation wheel_fl_low "seq_suspension.smd" frame 0 0 subtract neutral 0 weightlist wheel_fl
$animation wheel_fl_high "seq_suspension.smd" frame 2 2 subtract neutral 0 weightlist wheel_fl
$sequence wheel_fl_suspension { wheel_fl_low wheel_fl_high blend "vehicle_wheel_fl_height" 0 1.0 } weightlist wheel_fl delta autoplay

$weightlist rotate_fl { "Wheel_FL_Rotate" 1.0 }
$animation wheel_fl_spin0 "seq_spin.smd" frame 0 0 subtract neutral 0 weightlist rotate_fl
$animation wheel_fl_spin120 "seq_spin.smd" frame 1 1 subtract neutral 0 weightlist rotate_fl
$animation wheel_fl_spin240 "seq_spin.smd" frame 2 2 subtract neutral 0 weightlist rotate_fl
$sequence wheel_fl_spin { wheel_fl_spin0 wheel_fl_spin120 wheel_fl_spin240 wheel_fl_spin0 blendwidth 4 blend "vehicle_wheel_fl_spin" -180 180 } weightlist rotate_fl delta autoplay

// rear right
$weightlist wheel_rr { "Wheel_RR" 1.0 }
$animation wheel_rr_low "seq_suspension.smd" frame 0 0 subtract neutral 0 weightlist wheel_rr
$animation wheel_rr_high "seq_suspension.smd" frame 2 2 subtract neutral 0 weightlist wheel_rr
$sequence wheel_rr_suspension { wheel_rr_low wheel_rr_high blend "vehicle_wheel_rr_height" 0 1.0 } weightlist wheel_rr delta autoplay

$weightlist rotate_rr { "Wheel_RR_Rotate" 1.0 }
$animation wheel_rr_spin0 "seq_spin.smd" frame 0 0 subtract neutral 0 weightlist rotate_rr
$animation wheel_rr_spin120 "seq_spin.smd" frame 1 1 subtract neutral 0 weightlist rotate_rr
$animation wheel_rr_spin240 "seq_spin.smd" frame 2 2 subtract neutral 0 weightlist rotate_rr
$sequence wheel_rr_spin { wheel_rr_spin0 wheel_rr_spin120 wheel_rr_spin240 wheel_rr_spin0 blendwidth 4 blend "vehicle_wheel_rr_spin" -180 180 } weightlist rotate_rr delta autoplay

// rear left
$weightlist wheel_rl { "Wheel_RL" 1.0 }
$animation wheel_rl_low "seq_suspension.smd" frame 0 0 subtract neutral 0 weightlist wheel_rl
$animation wheel_rl_high "seq_suspension.smd" frame 2 2 subtract neutral 0 weightlist wheel_rl
$sequence wheel_rl_suspension { wheel_rl_low wheel_rl_high blend "vehicle_wheel_rl_height" 0 1.0 } weightlist wheel_rl delta autoplay

$weightlist rotate_rl { "Wheel_RL_Rotate" 1.0 }
$animation wheel_rl_spin0 "seq_spin.smd" frame 0 0 subtract neutral 0 weightlist rotate_rl
$animation wheel_rl_spin120 "seq_spin.smd" frame 1 1 subtract neutral 0 weightlist rotate_rl
$animation wheel_rl_spin240 "seq_spin.smd" frame 2 2 subtract neutral 0 weightlist rotate_rl
$sequence wheel_rl_spin { wheel_rl_spin0 wheel_rl_spin120 wheel_rl_spin240 wheel_rl_spin0 blendwidth 4 blend "vehicle_wheel_rl_spin" -180 180 } weightlist rotate_rl delta autoplay

$collisionmodel "truck_physbox.smd"
{
     // Mass in kilograms
     $mass 1600

     $concave
}

$keyvalues
{
    "vehicle_entry"
    {
        // Entries are: Key = enter animation, Value = Hitbox group
        "enter1" "0"
    }
    "vehicle_exit"
    {
        // Entries are: Key = exit animation, Value = "upright" or "upsidedown"
        "exit1" "upright"
        "exit2" "upright"
    }
    vehicle_npc_passengers
    {
        role_barney
        {
            target_attachment seat_barney
            entry
            {
                animation get_in_truck
                priority 1
            }
            exit
            {
                animation exit_truck
                priority 1
            }
            idle
            {
                animation drive
                priority 1
            }
        }
    }
}
